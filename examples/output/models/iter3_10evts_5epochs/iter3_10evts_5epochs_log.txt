/Users/ianwang/.virtualenvs/ChargedParticalTracking/bin/python /Users/ianwang/Desktop/AI-Physics(2021)/ChargedParticalTracking/examples/gnn.py
Console output is saving to: /Users/ianwang/Desktop/AI-Physics(2021)/ChargedParticalTracking/logs
======Edge Network======
EdgeNetwork(
  (network): Sequential(
    (0): Linear(in_features=22, out_features=8, bias=True)
    (1): LayerNorm((8,), eps=1e-05, elementwise_affine=True)
    (2): Tanh()
    (3): Linear(in_features=8, out_features=1, bias=True)
    (4): Sigmoid()
  )
) 

======Node Network======
NodeNetwork(
  (network): Sequential(
    (0): Linear(in_features=33, out_features=8, bias=True)
    (1): LayerNorm((8,), eps=1e-05, elementwise_affine=True)
    (2): Tanh()
    (3): Linear(in_features=8, out_features=8, bias=True)
    (4): LayerNorm((8,), eps=1e-05, elementwise_affine=True)
    (5): Tanh()
  )
) 

Epoch 0
Reading output/pairs/100evts_volume8/event000001067-hits.csv...
Reading output/pairs/100evts_volume8/event000001067-pairs.csv...
Read complete. Loading graph...
Node count: 14809. Edge count: 62911
Graph loaded.
Process batch 0...
batch 0, loss 0.573084831237793
Reading output/pairs/100evts_volume8/event000001082-hits.csv...
Reading output/pairs/100evts_volume8/event000001082-pairs.csv...
Read complete. Loading graph...
Node count: 14496. Edge count: 59856
Graph loaded.
Process batch 1...
batch 1, loss 0.5421786904335022
Reading output/pairs/100evts_volume8/event000001001-hits.csv...
Reading output/pairs/100evts_volume8/event000001001-pairs.csv...
Read complete. Loading graph...
Node count: 14621. Edge count: 72321
Graph loaded.
Process batch 2...
batch 2, loss 0.6296648383140564
Reading output/pairs/100evts_volume8/event000001020-hits.csv...
Reading output/pairs/100evts_volume8/event000001020-pairs.csv...
Read complete. Loading graph...
Node count: 14815. Edge count: 77550
Graph loaded.
Process batch 3...
batch 3, loss 0.5754687786102295
Reading output/pairs/100evts_volume8/event000001033-hits.csv...
Reading output/pairs/100evts_volume8/event000001033-pairs.csv...
Read complete. Loading graph...
Node count: 14906. Edge count: 59570
Graph loaded.
Process batch 4...
batch 4, loss 0.6269866824150085
Reading output/pairs/100evts_volume8/event000001062-hits.csv...
Reading output/pairs/100evts_volume8/event000001062-pairs.csv...
Read complete. Loading graph...
Node count: 10804. Edge count: 24363
Graph loaded.
Process batch 5...
batch 5, loss 0.6303786039352417
Processed 6 batches in 964.8315517902374s
Training loss: 0.5962937374909719
Reading output/pairs/100evts_volume8/event000001039-hits.csv...
Reading output/pairs/100evts_volume8/event000001039-pairs.csv...
Read complete. Loading graph...
Node count: 13443. Edge count: 49901
Graph loaded.
Reading output/pairs/100evts_volume8/event000001057-hits.csv...
Reading output/pairs/100evts_volume8/event000001057-pairs.csv...
Read complete. Loading graph...
Node count: 15299. Edge count: 79963
Graph loaded.
Reading output/pairs/100evts_volume8/event000001044-hits.csv...
Reading output/pairs/100evts_volume8/event000001044-pairs.csv...
Read complete. Loading graph...
Node count: 15016. Edge count: 69140
Graph loaded.
Reading output/pairs/100evts_volume8/event000001035-hits.csv...
Reading output/pairs/100evts_volume8/event000001035-pairs.csv...
Read complete. Loading graph...
Node count: 15252. Edge count: 82558
Graph loaded.
Processed 281562 samples in 4 batches in 356.98749113082886s.
Validation loss: 0.60429447889328 acc: 0.7378836632784254
Epoch 1
Reading output/pairs/100evts_volume8/event000001001-hits.csv...
Reading output/pairs/100evts_volume8/event000001001-pairs.csv...
Read complete. Loading graph...
Node count: 14621. Edge count: 72321
Graph loaded.
Process batch 0...
batch 0, loss 0.5903146862983704
Reading output/pairs/100evts_volume8/event000001082-hits.csv...
Reading output/pairs/100evts_volume8/event000001082-pairs.csv...
Read complete. Loading graph...
Node count: 14496. Edge count: 59856
Graph loaded.
Process batch 1...
batch 1, loss 0.5245527625083923
Reading output/pairs/100evts_volume8/event000001033-hits.csv...
Reading output/pairs/100evts_volume8/event000001033-pairs.csv...
Read complete. Loading graph...
Node count: 14906. Edge count: 59570
Graph loaded.
Process batch 2...
batch 2, loss 0.5928484797477722
Reading output/pairs/100evts_volume8/event000001020-hits.csv...
Reading output/pairs/100evts_volume8/event000001020-pairs.csv...
Read complete. Loading graph...
Node count: 14815. Edge count: 77550
Graph loaded.
Process batch 3...
batch 3, loss 0.5443037748336792
Reading output/pairs/100evts_volume8/event000001062-hits.csv...
Reading output/pairs/100evts_volume8/event000001062-pairs.csv...
Read complete. Loading graph...
Node count: 10804. Edge count: 24363
Graph loaded.
Process batch 4...
batch 4, loss 0.6014721393585205
Reading output/pairs/100evts_volume8/event000001067-hits.csv...
Reading output/pairs/100evts_volume8/event000001067-pairs.csv...
Read complete. Loading graph...
Node count: 14809. Edge count: 62911
Graph loaded.
Process batch 5...
batch 5, loss 0.5374427437782288
Processed 6 batches in 951.4032032489777s
Training loss: 0.5651557644208273
Reading output/pairs/100evts_volume8/event000001057-hits.csv...
Reading output/pairs/100evts_volume8/event000001057-pairs.csv...
Read complete. Loading graph...
Node count: 15299. Edge count: 79963
Graph loaded.
Reading output/pairs/100evts_volume8/event000001044-hits.csv...
Reading output/pairs/100evts_volume8/event000001044-pairs.csv...
Read complete. Loading graph...
Node count: 15016. Edge count: 69140
Graph loaded.
Reading output/pairs/100evts_volume8/event000001035-hits.csv...
Reading output/pairs/100evts_volume8/event000001035-pairs.csv...
Read complete. Loading graph...
Node count: 15252. Edge count: 82558
Graph loaded.
Reading output/pairs/100evts_volume8/event000001039-hits.csv...
Reading output/pairs/100evts_volume8/event000001039-pairs.csv...
Read complete. Loading graph...
Node count: 13443. Edge count: 49901
Graph loaded.
Processed 281562 samples in 4 batches in 365.5592110157013s.
Validation loss: 0.5591974854469299 acc: 0.9081658746563812
Epoch 2
Reading output/pairs/100evts_volume8/event000001082-hits.csv...
Reading output/pairs/100evts_volume8/event000001082-pairs.csv...
Read complete. Loading graph...
Node count: 14496. Edge count: 59856
Graph loaded.
Process batch 0...
batch 0, loss 0.5222883820533752
Reading output/pairs/100evts_volume8/event000001067-hits.csv...
Reading output/pairs/100evts_volume8/event000001067-pairs.csv...
Read complete. Loading graph...
Node count: 14809. Edge count: 62911
Graph loaded.
Process batch 1...
batch 1, loss 0.5332409739494324
Reading output/pairs/100evts_volume8/event000001020-hits.csv...
Reading output/pairs/100evts_volume8/event000001020-pairs.csv...
Read complete. Loading graph...
Node count: 14815. Edge count: 77550
Graph loaded.
Process batch 2...
batch 2, loss 0.5252363681793213
Reading output/pairs/100evts_volume8/event000001033-hits.csv...
Reading output/pairs/100evts_volume8/event000001033-pairs.csv...
Read complete. Loading graph...
Node count: 14906. Edge count: 59570
Graph loaded.
Process batch 3...
batch 3, loss 0.5522738695144653
Reading output/pairs/100evts_volume8/event000001062-hits.csv...
Reading output/pairs/100evts_volume8/event000001062-pairs.csv...
Read complete. Loading graph...
Node count: 10804. Edge count: 24363
Graph loaded.
Process batch 4...
batch 4, loss 0.580033004283905
Reading output/pairs/100evts_volume8/event000001001-hits.csv...
Reading output/pairs/100evts_volume8/event000001001-pairs.csv...
Read complete. Loading graph...
Node count: 14621. Edge count: 72321
Graph loaded.
Process batch 5...
batch 5, loss 0.5224791169166565
Processed 6 batches in 977.0377721786499s
Training loss: 0.539258619149526
Reading output/pairs/100evts_volume8/event000001057-hits.csv...
Reading output/pairs/100evts_volume8/event000001057-pairs.csv...
Read complete. Loading graph...
Node count: 15299. Edge count: 79963
Graph loaded.
Reading output/pairs/100evts_volume8/event000001039-hits.csv...
Reading output/pairs/100evts_volume8/event000001039-pairs.csv...
Read complete. Loading graph...
Node count: 13443. Edge count: 49901
Graph loaded.
Reading output/pairs/100evts_volume8/event000001044-hits.csv...
Reading output/pairs/100evts_volume8/event000001044-pairs.csv...
Read complete. Loading graph...
Node count: 15016. Edge count: 69140
Graph loaded.
Reading output/pairs/100evts_volume8/event000001035-hits.csv...
Reading output/pairs/100evts_volume8/event000001035-pairs.csv...
Read complete. Loading graph...
Node count: 15252. Edge count: 82558
Graph loaded.
Processed 281562 samples in 4 batches in 351.8504800796509s.
Validation loss: 0.5315595418214798 acc: 0.9193392574282041
Epoch 3
Reading output/pairs/100evts_volume8/event000001001-hits.csv...
Reading output/pairs/100evts_volume8/event000001001-pairs.csv...
Read complete. Loading graph...
Node count: 14621. Edge count: 72321
Graph loaded.
Process batch 0...
batch 0, loss 0.5176723003387451
Reading output/pairs/100evts_volume8/event000001033-hits.csv...
Reading output/pairs/100evts_volume8/event000001033-pairs.csv...
Read complete. Loading graph...
Node count: 14906. Edge count: 59570
Graph loaded.
Process batch 1...
batch 1, loss 0.533052384853363
Reading output/pairs/100evts_volume8/event000001082-hits.csv...
Reading output/pairs/100evts_volume8/event000001082-pairs.csv...
Read complete. Loading graph...
Node count: 14496. Edge count: 59856
Graph loaded.
Process batch 2...
batch 2, loss 0.5133767127990723
Reading output/pairs/100evts_volume8/event000001020-hits.csv...
Reading output/pairs/100evts_volume8/event000001020-pairs.csv...
Read complete. Loading graph...
Node count: 14815. Edge count: 77550
Graph loaded.
Process batch 3...
batch 3, loss 0.501920223236084
Reading output/pairs/100evts_volume8/event000001067-hits.csv...
Reading output/pairs/100evts_volume8/event000001067-pairs.csv...
Read complete. Loading graph...
Node count: 14809. Edge count: 62911
Graph loaded.
Process batch 4...
batch 4, loss 0.5140363574028015
Reading output/pairs/100evts_volume8/event000001062-hits.csv...
Reading output/pairs/100evts_volume8/event000001062-pairs.csv...
Read complete. Loading graph...
Node count: 10804. Edge count: 24363
Graph loaded.
Process batch 5...
batch 5, loss 0.5592296123504639
Processed 6 batches in 1012.3768339157104s
Training loss: 0.523214598496755
Reading output/pairs/100evts_volume8/event000001057-hits.csv...
Reading output/pairs/100evts_volume8/event000001057-pairs.csv...
Read complete. Loading graph...
Node count: 15299. Edge count: 79963
Graph loaded.
Reading output/pairs/100evts_volume8/event000001044-hits.csv...
Reading output/pairs/100evts_volume8/event000001044-pairs.csv...
Read complete. Loading graph...
Node count: 15016. Edge count: 69140
Graph loaded.
Reading output/pairs/100evts_volume8/event000001039-hits.csv...
Reading output/pairs/100evts_volume8/event000001039-pairs.csv...
Read complete. Loading graph...
Node count: 13443. Edge count: 49901
Graph loaded.
Reading output/pairs/100evts_volume8/event000001035-hits.csv...
Reading output/pairs/100evts_volume8/event000001035-pairs.csv...
Read complete. Loading graph...
Node count: 15252. Edge count: 82558
Graph loaded.
Processed 281562 samples in 4 batches in 374.28474617004395s.
Validation loss: 0.5052544698119164 acc: 0.9197121770693488
Epoch 4
Reading output/pairs/100evts_volume8/event000001062-hits.csv...
Reading output/pairs/100evts_volume8/event000001062-pairs.csv...
Read complete. Loading graph...
Node count: 10804. Edge count: 24363
Graph loaded.
Process batch 0...
batch 0, loss 0.5565730333328247
Reading output/pairs/100evts_volume8/event000001033-hits.csv...
Reading output/pairs/100evts_volume8/event000001033-pairs.csv...
Read complete. Loading graph...
Node count: 14906. Edge count: 59570
Graph loaded.
Process batch 1...
batch 1, loss 0.5084095001220703
Reading output/pairs/100evts_volume8/event000001020-hits.csv...
Reading output/pairs/100evts_volume8/event000001020-pairs.csv...
Read complete. Loading graph...
Node count: 14815. Edge count: 77550
Graph loaded.
Process batch 2...
batch 2, loss 0.4852612614631653
Reading output/pairs/100evts_volume8/event000001082-hits.csv...
Reading output/pairs/100evts_volume8/event000001082-pairs.csv...
Read complete. Loading graph...
Node count: 14496. Edge count: 59856
Graph loaded.
Process batch 3...
batch 3, loss 0.5014927387237549
Reading output/pairs/100evts_volume8/event000001067-hits.csv...
Reading output/pairs/100evts_volume8/event000001067-pairs.csv...
Read complete. Loading graph...
Node count: 14809. Edge count: 62911
Graph loaded.
Process batch 4...
batch 4, loss 0.4982694089412689
Reading output/pairs/100evts_volume8/event000001001-hits.csv...
Reading output/pairs/100evts_volume8/event000001001-pairs.csv...
Read complete. Loading graph...
Node count: 14621. Edge count: 72321
Graph loaded.
Process batch 5...
batch 5, loss 0.47493693232536316
Processed 6 batches in 974.0477550029755s
Training loss: 0.5041571458180746
Reading output/pairs/100evts_volume8/event000001039-hits.csv...
Reading output/pairs/100evts_volume8/event000001039-pairs.csv...
Read complete. Loading graph...
Node count: 13443. Edge count: 49901
Graph loaded.
Reading output/pairs/100evts_volume8/event000001044-hits.csv...
Reading output/pairs/100evts_volume8/event000001044-pairs.csv...
Read complete. Loading graph...
Node count: 15016. Edge count: 69140
Graph loaded.
Reading output/pairs/100evts_volume8/event000001057-hits.csv...
Reading output/pairs/100evts_volume8/event000001057-pairs.csv...
Read complete. Loading graph...
Node count: 15299. Edge count: 79963
Graph loaded.
Reading output/pairs/100evts_volume8/event000001035-hits.csv...
Reading output/pairs/100evts_volume8/event000001035-pairs.csv...
Read complete. Loading graph...
Node count: 15252. Edge count: 82558
Graph loaded.
Processed 281562 samples in 4 batches in 353.06834721565247s.
Validation loss: 0.4830217584967613 acc: 0.9197370383787585
Node count: 14621. Edge count: 72321

Process finished with exit code 0
